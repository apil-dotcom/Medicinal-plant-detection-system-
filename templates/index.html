<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Plant AI</title>

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Bootstrap Icons -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<style>
/* ===========================
   GLOBAL STYLES
=========================== */
body{
    margin:0;
    font-family:'Segoe UI',sans-serif;
}

/* HERO */
.hero{
    height:90vh;
    background:
        linear-gradient(rgba(0,0,0,0.55),rgba(0,0,0,0.55)),
        url("https://images.unsplash.com/photo-1441974231531-c6227db76b6e");
    background-size:cover;
    background-position:center;
    display:flex;
    align-items:center;
    color:white;
    position:relative;
}

.hero h1{
    font-size:3rem;
    font-weight:700;
}

.hero .btn{
    background:#ffc107;
    border:none;
    padding:12px 30px;
    border-radius:30px;
    font-weight:600;
}

/* LANGUAGE TOOLBAR */
.language-toolbar{
    position:absolute;
    top:20px;
    right:20px;
    z-index:10001;
}

.lang-btn{
    background:rgba(39,174,96,0.95);
    color:white;
    border:none;
    padding:8px 18px;
    border-radius:30px;
    font-weight:600;
    cursor:pointer;
    box-shadow:0 4px 10px rgba(0,0,0,0.3);
}

.lang-menu{
    display:none;
    margin-top:10px;
    background:black;
    border-radius:20px;
    overflow:hidden;
    box-shadow:0 10px 30px rgba(0,0,0,0.25);
}

.lang-menu div{
    padding:10px 16px;
    cursor:pointer;
    font-size:14px;
    transition:0.3s;
}

.lang-menu div:hover{
    background:#27ae60;
    color:white;
}

/* HOW IT WORKS */
.how-it-works{
    background:linear-gradient(to right,#2ecc71,#27ae60);
    padding:70px 0;
    color:white;
}

.step-card{
    text-align:center;
    padding:20px;
}

.step-icon{
    background:white;
    color:#27ae60;
    width:65px;
    height:65px;
    border-radius:50%;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:28px;
    margin:0 auto 15px;
    box-shadow:0 4px 12px rgba(0,0,0,0.25);
}

/* ===========================
   CHATBOT STYLES
=========================== */
#chatbot-icon{
    position:fixed;
    bottom:20px;
    right:20px;
    width:60px;
    height:60px;
    background:#27ae60;
    color:white;
    border-radius:50%;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:28px;
    cursor:pointer;
    z-index:9999;
}

#chatbot-window{
    position:fixed;
    bottom:90px;
    right:20px;
    width:320px;
    height:400px;              /* fixed height */
    background:white;
    border-radius:10px;
    display:none;
    flex-direction:column;
    box-shadow:0 6px 20px rgba(0,0,0,0.3);
    z-index:10000;
    overflow:hidden;           /* important for scroll */
}

/* Header */
#chat-header{
    flex-shrink:0;
    background:#27ae60;
    color:white;
    padding:10px;
    display:flex;
    justify-content:space-between;
    align-items:center;
}

/* Scrollable chat body */
#chat-body{
    flex:1;
    padding:10px;
    overflow-y:auto;
    display:flex;
    flex-direction:column;
    gap:8px;
}

/* Footer */
#chat-footer{
    flex-shrink:0;
    display:flex;
    border-top:1px solid #ccc;
}

/* Input */
#chat-input{
    flex:1;
    padding:10px;
    border:none;
    outline:none;
}

/* Send button */
#send-chat{
    width:70px;
    border:none;
    background:#27ae60;
    color:white;
    cursor:pointer;
}

/* Messages */
.user-msg{
    align-self:flex-end;
    background:#27ae60;
    color:white;
    padding:6px 10px;
    border-radius:12px;
    display:inline-block;
    max-width:85%;
    word-break:break-word;
    white-space:pre-wrap;
}

.bot-msg{
    align-self:flex-start;
    background:#f1f1f1;
    padding:6px 10px;
    border-radius:12px;
    display:inline-block;
    max-width:85%;
    word-break:break-word;
    white-space:pre-wrap;
}

/* Scrollbar style */
#chat-body::-webkit-scrollbar {
    width: 6px;
}

#chat-body::-webkit-scrollbar-thumb {
    background: #bdbdbd;
    border-radius: 10px;
}
</style>
</head>

<body>

<div id="google_translate_element" style="display:none;"></div>

<!-- HERO -->
<section class="hero">
<div class="container text-center">
    <h1>Try our YOLO-Based <br>Medicinal Plant Detection System</h1>
    <p class="mt-3 mb-4">Upload or capture a plant leaf and get instant results</p>
    <a href="/predict" class="btn btn-warning">Try Now</a>
</div>

<div class="language-toolbar">
<button class="lang-btn" onclick="toggleLangMenu()">üåç Language</button>
<div class="lang-menu" id="langMenu">
    <div onclick="changeLanguage('en')">üá∫üá∏ English</div>
    <div onclick="changeLanguage('ne')">üá≥üáµ ‡§®‡•á‡§™‡§æ‡§≤‡•Ä</div>
    <div onclick="changeLanguage('hi')">üáÆüá≥ ‡§π‡§ø‡§Ç‡§¶‡•Ä</div>
    <div onclick="changeLanguage('fr')">üá´üá∑ Fran√ßais</div>
    <div onclick="changeLanguage('de')">üá©üá™ Deutsch</div>
    <div onclick="changeLanguage('it')">üáÆüáπ Italiano</div>
</div>
</div>
</section>

<!-- HOW IT WORKS -->
<section class="how-it-works text-center">
<div class="container">
<h2 class="mb-5">How it works?</h2>
<div class="row">
<div class="col-md-3 col-6 step-card">
    <div class="step-icon"><i class="bi bi-camera"></i></div>
    <h6>Click a Pic</h6>
    <p>Take a picture of your plant</p>
</div>
<div class="col-md-3 col-6 step-card">
    <div class="step-icon"><i class="bi bi-upload"></i></div>
    <h6>Upload</h6>
    <p>Upload the leaf image</p>
</div>
<div class="col-md-3 col-6 step-card">
    <div class="step-icon"><i class="bi bi-cpu"></i></div>
    <h6>AI Analysis</h6>
    <p>Plant AI analyzes your plant</p>
</div>
<div class="col-md-3 col-6 step-card">
    <div class="step-icon"><i class="bi bi-check-circle"></i></div>
    <h6>Get Result</h6>
    <p>Medicinal plant identified</p>
</div>
</div>
</div>
</section>

<!-- CHATBOT -->
<div id="chatbot-icon"><i class="bi bi-chat-dots-fill"></i></div>

<div id="chatbot-window">
    <div id="chat-header">
        <span>Plant AI Chatbot</span>
        <button id="close-chat">&times;</button>
    </div>

    <div id="chat-body"></div>

    <div id="chat-footer">
        <input type="text" id="chat-input" placeholder="Ask a question...">
        <button id="send-chat">Send</button>
    </div>
</div>

<script>
/* CHATBOT TOGGLE */
$("#chatbot-icon").click(()=>$("#chatbot-window").toggle());
$("#close-chat").click(()=>$("#chatbot-window").hide());

/* SEND MESSAGE */
$("#send-chat").click(function(){
    let msg=$("#chat-input").val();
    if(msg.trim()==="")return;

    $("#chat-body").append('<div class="user-msg">'+msg+'</div>');
    $("#chat-input").val("");

    $.ajax({
        url:"/chat",
        method:"POST",
        contentType:"application/json",
        data:JSON.stringify({
            question:msg,
            plant_name:"{{ plant_name if plant_name else '' }}"
        }),
        success:function(res){
            $("#chat-body").append('<div class="bot-msg">'+res.answer+'</div>');
            $("#chat-body").scrollTop($("#chat-body")[0].scrollHeight);
        },
        error:function(){
            $("#chat-body").append('<div class="bot-msg">‚ùå AI service error</div>');
            $("#chat-body").scrollTop($("#chat-body")[0].scrollHeight);
        }
    });
});

/* ENTER KEY SEND */
$("#chat-input").keypress(function(e){
    if(e.which==13){
        $("#send-chat").click();
        return false;
    }
});

/* LANGUAGE TOGGLE */
function toggleLangMenu(){
    const m=document.getElementById("langMenu");
    m.style.display=m.style.display==="block"?"none":"block";
}

/* GOOGLE TRANSLATE */
function googleTranslateElementInit(){
    new google.translate.TranslateElement({pageLanguage:'en',autoDisplay:false},'google_translate_element');
}

function changeLanguage(lang){
    const s=document.querySelector("select.goog-te-combo");
    if(!s)return;
    s.value=lang;
    s.dispatchEvent(new Event("change"));
}
</script>
<script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

</body>
</html>
